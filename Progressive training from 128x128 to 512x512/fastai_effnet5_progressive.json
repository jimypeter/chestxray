{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "from fastai.vision import *\n",
    "from fastai.callbacks import *\n",
    "from fastai.vision.models.efficientnet import *"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_path = Path('./chest_xray').absolute()\n",
    "model_path = Path('./model').absolute()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LabelLists;\n",
       "\n",
       "Train: LabelList (5232 items)\n",
       "x: ImageList\n",
       "Image (3, 952, 1192),Image (3, 944, 1416),Image (3, 1128, 1664),Image (3, 656, 1016),Image (3, 712, 1072)\n",
       "y: CategoryList\n",
       "bacteria,bacteria,bacteria,bacteria,bacteria\n",
       "Path: /media/yyang/data/pneumonia/chest_xray;\n",
       "\n",
       "Valid: LabelList (624 items)\n",
       "x: ImageList\n",
       "Image (3, 1010, 1462),Image (3, 720, 1410),Image (3, 712, 976),Image (3, 1400, 1648),Image (3, 544, 1016)\n",
       "y: CategoryList\n",
       "virus,bacteria,bacteria,virus,bacteria\n",
       "Path: /media/yyang/data/pneumonia/chest_xray;\n",
       "\n",
       "Test: None"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "stats = ([0.48746821, 0.48746821, 0.48746821], [0.24557937, 0.24557937, 0.24557937])\n",
    "\n",
    "def valid_func(o):\n",
    "    return 'test' in str(o)\n",
    "\n",
    "def label_func(o):\n",
    "    name = o.name\n",
    "    if 'virus' in name:\n",
    "        return 'virus'\n",
    "    if 'bacteria' in name:\n",
    "        return 'bacteria'\n",
    "    return 'normal'\n",
    "\n",
    "src = (ImageList.from_folder(data_path)\n",
    "        .split_by_valid_func(valid_func)\n",
    "        .label_from_func(label_func)\n",
    "        )\n",
    "\n",
    "src"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(ImageDataBunch;\n",
       " \n",
       " Train: LabelList (5232 items)\n",
       " x: ImageList\n",
       " Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128)\n",
       " y: CategoryList\n",
       " bacteria,bacteria,bacteria,bacteria,bacteria\n",
       " Path: /media/yyang/data/pneumonia/chest_xray;\n",
       " \n",
       " Valid: LabelList (624 items)\n",
       " x: ImageList\n",
       " Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128),Image (3, 128, 128)\n",
       " y: CategoryList\n",
       " virus,bacteria,bacteria,virus,bacteria\n",
       " Path: /media/yyang/data/pneumonia/chest_xray;\n",
       " \n",
       " Test: None,\n",
       " ['bacteria', 'normal', 'virus'])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def get_data(bs, sz):\n",
    "    return (src.transform(get_transforms(), size=sz)\n",
    "            .databunch(bs=bs)\n",
    "            .normalize(stats)\n",
    "            )\n",
    "\n",
    "data = get_data(64, 128)\n",
    "data, data.classes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Loaded pretrained weights for efficientnet-b5\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "EfficientNet(\n",
       "  (_conv_stem): Conv2dStaticSamePadding(\n",
       "    3, 48, kernel_size=(3, 3), stride=(2, 2), bias=False\n",
       "    (static_padding): ZeroPad2d(padding=(0, 1, 0, 1), value=0.0)\n",
       "  )\n",
       "  (_bn0): BatchNorm2d(48, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "  (_blocks): ModuleList(\n",
       "    (0): MBConvBlock(\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        48, 48, kernel_size=(3, 3), stride=[1, 1], groups=48, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(48, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        48, 12, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        12, 48, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        48, 24, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(24, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (1): MBConvBlock(\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        24, 24, kernel_size=(3, 3), stride=(1, 1), groups=24, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(24, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        24, 6, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        6, 24, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        24, 24, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(24, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (2): MBConvBlock(\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        24, 24, kernel_size=(3, 3), stride=(1, 1), groups=24, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(24, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        24, 6, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        6, 24, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        24, 24, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(24, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (3): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        24, 144, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(144, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        144, 144, kernel_size=(3, 3), stride=[2, 2], groups=144, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(0, 1, 0, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(144, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        144, 6, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        6, 144, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        144, 40, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(40, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (4): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        240, 240, kernel_size=(3, 3), stride=(1, 1), groups=240, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        240, 10, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        10, 240, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(40, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (5): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        240, 240, kernel_size=(3, 3), stride=(1, 1), groups=240, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        240, 10, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        10, 240, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(40, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (6): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        240, 240, kernel_size=(3, 3), stride=(1, 1), groups=240, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        240, 10, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        10, 240, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(40, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (7): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        240, 240, kernel_size=(3, 3), stride=(1, 1), groups=240, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        240, 10, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        10, 240, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        240, 40, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(40, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (8): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        40, 240, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        240, 240, kernel_size=(5, 5), stride=[2, 2], groups=240, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 2, 1, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(240, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        240, 10, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        10, 240, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        240, 64, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(64, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (9): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        64, 384, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        384, 384, kernel_size=(5, 5), stride=(1, 1), groups=384, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        384, 16, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        16, 384, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        384, 64, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(64, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (10): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        64, 384, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        384, 384, kernel_size=(5, 5), stride=(1, 1), groups=384, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        384, 16, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        16, 384, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        384, 64, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(64, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (11): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        64, 384, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        384, 384, kernel_size=(5, 5), stride=(1, 1), groups=384, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        384, 16, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        16, 384, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        384, 64, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(64, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (12): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        64, 384, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        384, 384, kernel_size=(5, 5), stride=(1, 1), groups=384, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        384, 16, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        16, 384, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        384, 64, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(64, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (13): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        64, 384, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        384, 384, kernel_size=(3, 3), stride=[2, 2], groups=384, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(0, 1, 0, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(384, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        384, 16, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        16, 384, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        384, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (14): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (15): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (16): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (17): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (18): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (19): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(3, 3), stride=(1, 1), groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(128, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (20): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        128, 768, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        768, 768, kernel_size=(5, 5), stride=[1, 1], groups=768, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(768, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        768, 32, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        32, 768, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        768, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (21): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (22): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (23): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (24): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (25): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (26): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=(1, 1), groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 176, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(176, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (27): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        176, 1056, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1056, 1056, kernel_size=(5, 5), stride=[2, 2], groups=1056, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 2, 1, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1056, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1056, 44, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        44, 1056, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1056, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (28): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (29): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (30): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (31): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (32): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (33): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (34): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (35): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(5, 5), stride=(1, 1), groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(2, 2, 2, 2), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 304, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(304, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (36): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        304, 1824, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        1824, 1824, kernel_size=(3, 3), stride=[1, 1], groups=1824, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(1824, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        1824, 76, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        76, 1824, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        1824, 512, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(512, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (37): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        512, 3072, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(3072, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        3072, 3072, kernel_size=(3, 3), stride=(1, 1), groups=3072, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(3072, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        3072, 128, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        128, 3072, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        3072, 512, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(512, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "    (38): MBConvBlock(\n",
       "      (_expand_conv): Conv2dStaticSamePadding(\n",
       "        512, 3072, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn0): BatchNorm2d(3072, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_depthwise_conv): Conv2dStaticSamePadding(\n",
       "        3072, 3072, kernel_size=(3, 3), stride=(1, 1), groups=3072, bias=False\n",
       "        (static_padding): ZeroPad2d(padding=(1, 1, 1, 1), value=0.0)\n",
       "      )\n",
       "      (_bn1): BatchNorm2d(3072, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_se_reduce): Conv2dStaticSamePadding(\n",
       "        3072, 128, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_se_expand): Conv2dStaticSamePadding(\n",
       "        128, 3072, kernel_size=(1, 1), stride=(1, 1)\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_project_conv): Conv2dStaticSamePadding(\n",
       "        3072, 512, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "        (static_padding): Identity()\n",
       "      )\n",
       "      (_bn2): BatchNorm2d(512, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "      (_swish): MemoryEfficientSwish()\n",
       "    )\n",
       "  )\n",
       "  (_conv_head): Conv2dStaticSamePadding(\n",
       "    512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False\n",
       "    (static_padding): Identity()\n",
       "  )\n",
       "  (_bn1): BatchNorm2d(2048, eps=0.001, momentum=0.010000000000000009, affine=True, track_running_stats=True)\n",
       "  (_avg_pooling): AdaptiveAvgPool2d(output_size=1)\n",
       "  (_dropout): Dropout(p=0.4, inplace=False)\n",
       "  (_fc): Linear(in_features=2048, out_features=1000, bias=True)\n",
       "  (_swish): MemoryEfficientSwish()\n",
       ")"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = EfficientNet.from_pretrained('efficientnet-b5')\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "model._fc = nn.Linear(2048, 3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn = Learner(data, \n",
    "                model,\n",
    "                bn_wd=False,\n",
    "                metrics=error_rate,\n",
    "                loss_func=LabelSmoothingCrossEntropy(),\n",
    "                callback_fns=[BnFreeze,\n",
    "                              partial(SaveModelCallback, monitor='error_rate', name='best_error')\n",
    "                             ],\n",
    "               ).to_fp16()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.843553</td>\n",
       "      <td>0.945322</td>\n",
       "      <td>0.418269</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.797999</td>\n",
       "      <td>0.964104</td>\n",
       "      <td>0.375000</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.759049</td>\n",
       "      <td>0.806729</td>\n",
       "      <td>0.264423</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.729522</td>\n",
       "      <td>0.743061</td>\n",
       "      <td>0.237179</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.701144</td>\n",
       "      <td>0.755316</td>\n",
       "      <td>0.245192</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.41826921701431274.\n",
      "Better model found at epoch 1 with error_rate value: 0.375.\n",
      "Better model found at epoch 2 with error_rate value: 0.26442307233810425.\n",
      "Better model found at epoch 3 with error_rate value: 0.2371794879436493.\n"
     ]
    }
   ],
   "source": [
    "learn.split(lambda m: (model._conv_head,))\n",
    "learn.freeze()\n",
    "learn.fit_one_cycle(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='1' class='' max='2', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      50.00% [1/2 00:38<00:38]\n",
       "    </div>\n",
       "    \n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2.061007</td>\n",
       "      <td>#na#</td>\n",
       "      <td>00:38</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table><p>\n",
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='1' class='' max='81', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      1.23% [1/81 00:05<07:59 2.2904]\n",
       "    </div>\n",
       "    "
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.\n"
     ]
    }
   ],
   "source": [
    "learn.unfreeze()\n",
    "learn.lr_find()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Min numerical gradient: 2.29E-06\n",
      "Min loss divided by 10: 1.00E-06\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3deZxddX3/8ddn7uyTWZLMTJbJJBNCIAsSloBGWkVFBepDRLEldS3WtLXSh1V/P9uHfYjVn1vVWq1tlVIEpIKA1YJVAamWSgIkIYtZCGafyTJLZt/v8vn9cW/CNcxK5sy5d+77+XjcR+5Z7j2fb2bmvu8533O+x9wdERHJXXlhFyAiIuFSEIiI5DgFgYhIjlMQiIjkOAWBiEiOyw+7gMmqrq72hoaGsMsQEckqW7dubXP3mpGWZV0QNDQ0sGXLlrDLEBHJKmZ2ZLRlOjQkIpLjFAQiIjlOQSAikuMUBCIiOU5BICKS4xQEIiI5TkEgIpLjFAQiIlngH37+Ak/tbwvkvRUEIiIZrmcwytef+A1bDncE8v4KAhGRDPfrY124w5r6ykDeP7AgMLM7zazFzHaNs94VZhY3s5uCqkVEJJttb+wE4JL6qkDeP8g9gruAa8dawcwiwJeARwOsQ0Qkq20/2snS6jKqSgsDef/AgsDdnwTax1ntVuAHQEtQdYiIZDN3Z3tjJ2sWBXNYCELsIzCzOuBG4Fth1SAikulOdg/S0jMU2GEhCLez+B+AT7h7fLwVzWyDmW0xsy2tra3TUJqISGbYfjTVP7B4dmDbCPN+BGuB+80MoBq43sxi7v6js1d099uB2wHWrl3r01qliEiItjd2UhjJY+WC8sC2EVoQuPvS08/N7C7gxyOFgIhILtvW2MnKhRUU5UcC20ZgQWBm9wFXA9Vm1gTcBhQAuLv6BURExhGLJ/h1Uxd/cEV9oNsJLAjcff0k1n1/UHWIiGSr37T0MhCNB9pRDLqyWEQkY52+kGyNgkBEJDdtP9pJVWkBDXNLA92OgkBEJEPtaOpkzaIqUmdXBkZBICKSgfqGYrzQ3BN4/wAoCEREMtLOpi4SHtxAc+kUBCIiGWhH0/R0FIOCQEQkI20/2smSuaXMKQtmxNF0CgIRkQyUHHE0+L0BUBCIiGSck12DnOwenJb+AVAQiIhknDN3JFusIBARyUm7jnURyTNWLaiYlu0pCEREMsyR9n4WVhVTXBDciKPpFAQiIhmmsb2fxXOCHVYinYJARCTDNHX0Uz9bQSAikpP6h2O09Q5Trz0CEZHc1NQxAMCi2SXTtk0FgYhIBjl6qh9AewQiIrmqsSMZBOosFhHJUY3tA5QURJg7DWMMnRZYEJjZnWbWYma7Rll+g5ntNLPtZrbFzH4nqFpERLJFY0c/9XNKAr8ZTbog9wjuAq4dY/kTwBp3vwS4BbgjwFpERLJCY/v0njoKAQaBuz8JtI+xvNfdPTVZBvho64qI5AJ3TwbBNPYPQMh9BGZ2o5k9D/wXyb2C0dbbkDp8tKW1tXX6ChQRmUYd/VH6huO5FQTu/kN3XwG8DfjsGOvd7u5r3X1tTU3N9BUoIjKNGttTp45O4zUEkCFnDaUOIy0zs+qwaxERCcvpU0dzZo/AzM63VLe4mV0GFAKnwqpHRCRsR9vDCYL8oN7YzO4DrgaqzawJuA0oAHD3bwHvAN5rZlFgAPiDtM5jEZGc09g+wOzSAmYVBfbRPKLAtubu68dZ/iXgS0FtX0Qk2zR1TO/w06dlRB+BiIgkO4sXKQhERHJTPOEc6xyY9ovJQEEgIpIRTnYPEo079XOm99RRUBCIiGSE09cQqI9ARCRHvXgxmYJARCQnNXYMYAYLq3RoSEQkJzW297OgopjC/On/WFYQiIhkgLBOHQUFgYhIRmgM6WIyUBCIiIRuMBqnuXsolI5iUBCIiITuWOcAQCjXEICCQEQkdGGNOnqagkBEJGRNIV5DAAoCEZHQNXYMUJifR215USjbVxCIiISssb2fRbNLyMuzULavIBARCdnR9v7QDguBgkBEJHSN7f2hnTEECgIRkVA1tvfTPRijYW5ZaDUEFgRmdqeZtZjZrlGWv8vMdqYeG81sTVC1iIhkqnufOUIkz/i9ixeEVkOQewR3AdeOsfwQ8Fp3vxj4LHB7gLWIiGScwWicBzY38saV81hQGd6hoSBvXv+kmTWMsXxj2uTTwKKgahERyUQ/3nmCjv4o7123JNQ6MqWP4APAT0dbaGYbzGyLmW1pbW2dxrJERILz3U2HOb92FuuWzQ21jtCDwMxeRzIIPjHaOu5+u7uvdfe1NTU101eciEhAdjR2sqOpi/e8aglm4Vw/cFpgh4YmwswuBu4ArnP3U2HWIiIyne7ZdISywghvv6wu7FLC2yMws8XAfwDvcfcXwqpDRGS6tfcN88jO49x4WR3lxQVhlxPcHoGZ3QdcDVSbWRNwG1AA4O7fAj4FzAX+ObVbFHP3tUHVIyKSKR7Y0shwLMF71zWEXQoQ7FlD68dZ/sfAHwe1fRGRTBRPOPc+fYRXLp3DBfPKwy4HyIDOYhGRXPKL51to6hjImL0BUBCIiEyr+zc3UlNexJtWzwu7lDMUBCIi06Szf5j/eaGFG9YspCCSOR+/mVOJiMgM99NdJ4nGnRsuCf+U0XQKAhGRafKjbcc4r6aMi+oqwi7ltygIRESmwfHOAZ493M4Na+pCv5L4bAoCEZFp8OOdx3GHGy5ZGHYpL6EgEBGZBj/adpw19VU0VId3A5rRKAhERAL2m+Ye9pzo5oY1mbc3AAoCEZHAPbzjOHkGb1kT3l3IxqIgEBEJkLvzn9uPc9X51dSWF4ddzogUBCIiAdrW2MnR9v6Mu3YgnYJARCRAD28/TmF+Hm/OoCElzqYgEBEJSCye4Mc7j3PNytqMuO/AaBQEIiIB2dbYSVvvMG+5ODPPFjpNQSAiEpCn9rdhBlctqw67lDEpCEREArJx/ykuWlhJZWnmHhYCBYGISCD6h2Nsa+zg1efPDbuUcQUWBGZ2p5m1mNmuUZavMLNNZjZkZh8Pqg4RkTBsPtxBNO4Zf1gIgt0juAu4dozl7cBfAF8JsAYRkVBs3N9GYSSPKxrmhF3KuAILAnd/kuSH/WjLW9x9MxANqgYRkbA8daCNSxdXUVIYCbuUcWVFH4GZbTCzLWa2pbW1NexyRETG1Nk/zO7j3bw6Cw4LQZYEgbvf7u5r3X1tTU1N2OWIiIxp04FTuMNVWdBRDFkSBCIi2eSpA22UFUZYU18VdikToiAQEZliG/ef4sqlcyiIZMdHbP5EVjKzZUCTuw+Z2dXAxcA97t45xmvuA64Gqs2sCbgNKABw92+Z2XxgC1ABJMzsI8Aqd+8+h/aIiITqRNcAB9v6+MNXLg67lAmbUBAAPwDWmtn5wL8BDwPfA64f7QXuvn6sN3T3k8CiCW5fRCQrbNx/CoB1y7KjfwAmfmgo4e4x4EbgH9z9L4HMvNWOiEiInjrQxpyyQlbOrwi7lAmbaBBEzWw98D7gx6l5mT14hojINHN3Nu4/xbrz5pKXZ2GXM2ETDYI/AtYBn3P3Q2a2FLg3uLJERLLPwbY+TnYPZsX4Qukm1Efg7ntIDgeBmc0Gyt39i0EWJiKSbTbubwMyf9jps01oj8DMfmlmFWY2B9gBfMfM/j7Y0kREssvTB9tZWFnMkrmlYZcyKRM9NFSZOq3z7cB33P1y4JrgyhIRyT47j3Vy6eLZmGVP/wBMPAjyzWwB8Pu82FksIiIpXf1RGtsHWF2XPWcLnTbRIPgM8ChwwN03m9l5wG+CK0tEJLvsPt4FwEULK0OuZPIm2ln8IPBg2vRB4B1BFSUikm12pYJg9cIZukdgZovM7IepO441m9kPzExXBYuIpOw61s3CymLmzioKu5RJm+ihoe+QHFZiIVAHPJKaJyIiJPcILqrLvsNCMPEgqHH377h7LPW4C9CNAUREgN6hGIfa+mZ8ELSZ2bvNLJJ6vBs4FWRhIiLZYu+Jbtzhoiw8YwgmHgS3kDx19CRwAriJ5LATIiI5b9ex7D1jCCYYBO5+1N3f6u417l7r7m8jeXGZiEjO23Wsm5ryImorisMu5WU5l9vnfHTKqhARyWK7j3dxURaeNnrauQRBdl1DLSISgMFonN+09GZtRzGcWxD4lFUhIpKl9p7oJp5wVmdp/wCMEwRm1mNm3SM8ekheUzDWa+9MXYC2a5TlZmbfMLP9ZrbTzC47h3aIiIRi1/Hkbdaz9YwhGCcI3L3c3StGeJS7+3jDU9wFXDvG8uuA5anHBuBfJlO4iEgm2H2si6rSAuqqSsIu5WU7l0NDY3L3J4H2MVa5AbjHk54GqlIjnIqIZI1dx7u4aGFl1g09nS6wIJiAOqAxbbopNe8lzGyDmW0xsy2tra3TUpyIyHiGYwn2nezJyqGn04UZBCPF54gd0O5+u7uvdfe1NTUa2UJEMsMLzT1E484rsviMIQg3CJqA+rTpRcDxkGoREZm0bL4HQbowg+Bh4L2ps4deBXS5+4kQ6xERmZRdx7opL8pn8Zzsukfx2SZ0Y5qXw8zuA64Gqs2sCbgNKABw928BPwGuB/YD/WjsIhHJMruOd7FqYQV5ednbUQwBBoG7rx9nuQN/HtT2RUSCFIsn2Huim3e9cknYpZyzMA8NiYhkrReaexmMJrL6QrLTFAQiIi/Dj7YfI5JnXLWsOuxSzpmCQERkkoZicR7a2sQbV87L2qGn0ykIREQm6dHdzbT3DbP+lYvDLmVKKAhERCbpe88coX5OCb97fvYfFgIFgYjIpBxo7eXpg+3cfMXirD9t9DQFgYjIJNz3zFHy84x3rl0UdilTRkEgIjJBg9E4Dz3XxJtWz6O2PPs7iU9TEIiITNDPdp2ksz/KH16Z/ReRpVMQiIhM0PeePcqSuaW8etncsEuZUgoCEZEJ2N/Sw7OH2ll/5czpJD5NQSAiMgHfe6aRgohx0+Uzp5P4NAWBiMg4BobjPLS1kTevnk/1rKKwy5lyCgIRkXH85/ZjdA/GeO+6hrBLCYSCQERkDO7O3ZuOsGJ+OVc0zA67nEAoCERExrD1SAd7T3Tz3nUNmM2sTuLTFAQiImO4Z9MRyovzedulC8MuJTAKAhGRUbT0DPLTXSd45+X1lBYGdkPH0AUaBGZ2rZntM7P9ZvZXIyxfYmZPmNlOM/ulmc2887JEJGvd/2wj0bjznnUz60riswUWBGYWAf4JuA5YBaw3s1VnrfYV4B53vxj4DPCFoOoREZmMaDzBvz9zhN9dXs3S6rKwywlUkHsEVwL73f2guw8D9wM3nLXOKuCJ1PNfjLBcRCQUj+9pprl7iPfN0FNG0wUZBHVAY9p0U2peuh3AO1LPbwTKzWxmDeIhIlnp7o2Hqasq4XUrasMuJXBBBsFI51n5WdMfB15rZtuA1wLHgNhL3shsg5ltMbMtra2tU1+piEiavSe6eeZQO+9+1RIiM2xcoZEEGQRNQH3a9CLgePoK7n7c3d/u7pcCn0zN6zr7jdz9dndf6+5ra2pqAixZRHKdu/P5n+ylvDifm6+oH/8FM0CQQbAZWG5mS82sELgZeDh9BTOrNrPTNfw1cGeA9YiIjOuJvS3872/a+Mg1FzC7rDDscqZFYEHg7jHgw8CjwF7gAXffbWafMbO3pla7GthnZi8A84DPBVWPiMh4hmJx/t9/7WFZTRnvneGnjKYL9AoJd/8J8JOz5n0q7flDwENB1iAiMlF3PXWYw6f6ufuWKymI5M71trnTUhGRMbT0DPKP/72fN6yo5bUX5FZfpIJARAT4yqP7GIrF+Zu3nH3d68ynIBCRnLezqZMHtzZxy1VLZ/xVxCNREIhIzvv8T/Yyt6yQD7/+/LBLCYWCQERyWkv3IE8fbOd96xooLy4Iu5xQKAhEJKf9fG8LAG9cPS/kSsKjIBCRnPbzvc3UzynhwnnlYZcSGgWBiOSs/uEYv9rfxjUr583Y21BOhIJARHLWky+0MRxL8MaVuXtYCBQEIpLDfr63mYrifK5YOifsUkKlIBCRnBRPOP/9fAuvW1GbU8NJjCS3Wy8iOWvb0Q7a+4a5JscPC4GCQERy1ON7mimIGK+9MLfGFRqJgkBEctLje5t51XlzqcjRi8jSKQhEJOccaO3lYGufDgulKAhEJOc8sbcZgGtWKQhAQSAiOejxPc2sWlBBXVVJ2KVkBAWBiOSUU71DbD3Sob2BNAoCEckZ0XiCLz+6j4TDmxQEZwQaBGZ2rZntM7P9ZvZXIyxfbGa/MLNtZrbTzK4Psh4RyV3tfcO859+e4f7NjfzJa89j9cKKsEvKGIHdvN7MIsA/AW8EmoDNZvawu+9JW+1vgAfc/V/MbBXJG903BFWTiOSmvSe6+eA9W2jpGeLvf38Nb79sUdglZZTAggC4Etjv7gcBzOx+4AYgPQgcOB3LlcDxAOsRkRz0s10n+egD2ykvzueBP1nHJfVVYZeUcYIMgjqgMW26CXjlWet8GnjMzG4FyoBrRnojM9sAbABYvHjxlBcqIjPTya5B/uK+baxcWMG/vudyaiuKwy4pIwXZRzDS4N5+1vR64C53XwRcD3zXzF5Sk7vf7u5r3X1tTY0uBxeRifn2kweIu/PN9ZcqBMYQZBA0AfVp04t46aGfDwAPALj7JqAYqA6wJhHJEa09Q3zvmaPceGkd9XNKwy4nowUZBJuB5Wa21MwKgZuBh89a5yjwBgAzW0kyCFoDrElEcsQdvzpINJ7gQ1cvC7uUjBdYELh7DPgw8Ciwl+TZQbvN7DNm9tbUah8DPmhmO4D7gPe7+9mHj0REJqWjb5jvbjrCWy5eyHk1s8IuJ+MF2VmMu/+E5Cmh6fM+lfZ8D3BVkDWISO6586lD9A/H+fDrzw+7lKygK4tFZEbpGohy11OHue6i+VwwrzzscrKCgkBEZpS7Nx6mZyimvYFJUBCIyIzROxTjzqcOcc3KWlYvrAy7nKyhIBCRGcHd+fLPnqezP8qtr18edjlZRUEgIjPCN57Yz92bjnDLVUtZo2EkJkVBICJZ7ztPHeJrP3+Bmy5fxN/83sqwy8k6CgIRyWoPbW3ibx/Zw5tXz+OLb38FeXkjjW4jY1EQiEjW+tmuk3ziBzv5nfOr+cb6S8mP6CPt5Qj0gjIRkanm7mw+3MHtTx7g53tbuHRxFd9+z+UU5UfCLi1rKQhEJCvEE86ju0/y7ScPsqOxkzllhXzkmuV84HeWUlakj7Jzof89Ecloje39PLilkQe3NnGia5CGuaV89m0XcdNliygp1F7AVFAQiEjGGY4leHxPM/dvPsqv9rcB8NoLavj0W1dzzcp5RNQhPKUUBCKSMZo6+rnv2aN8f3MTbb1D1FWV8JE3XMBNaxdRV1USdnkzloJARELTMxhlf0svv2nu5dHdJ/nFvhYAXr+ilne9agmvWV6jb//TQEEgItNmMBrn0d0neXj7cfae6OZ41+CZZdWzivjQ1eez/pWL9e1/mikIgnbgAHz1q3DvvdDbC7NmwbvfDR/7GCzTnZMkN+w90c33Nzfyw23H6BqIsmh2CVcuncPyeeUsr53FBfPKqZ9Tqm//IVEQpHF3DrX1kXCnKD9CSWGEkoLk42VdrfjTn8JNN0E0mnwA9PTAHXfA3XfDQw/BdddNbSNEQhKLJxiKJegZjLH3ZDd7jicfu493cfhUP4WRPK69aD43X1nPq5bO1RXAGURBkDIUi3Pbf+7m/s2NIy4vLYxQVpTPrNRjXkUxdVXFLKwqYWFVCeXF+QwMx+kfjtMfjVN05BA3/dFN5A30v/TNTgfDTTfBzp3aM5CMdvoCrrs3HeYXz7eQcCfPjDwzzJLn9w/FEsQTL73LbP2cElYvqOT9r27ghkvqmF1WOP0NkHEFGgRmdi3wdSAC3OHuXzxr+deA16UmS4Fad5/2YQObuwf503u3su1oJxtecx6vqKtkMBpnMBpnIBqnbyhO31CMvuEYvUNxugeiNHX088yhU/QMxkZ8z88+9s/EhoYY89c+GoWvfQ2++c0RF7s7B1r7aO8bJpIHZkbEjJLCCEuryyjQ5fQyhdydeMKJu+MOQ9EEP9l1grs3Hub5kz1UFOdzwyV1VBTnk3An4ckQKIgYRfkRivLzKCrIo6Qwn+W1s1i5oILKkoKwmyUTYEHdK97MIsALwBuBJmAzsD51n+KR1r8VuNTdbxnrfdeuXetbtmyZdD0t3YM8d7STC+eXszjtWOTWIx382b1b6R2K8ZV3ruH6VyyY1Pv2DEY50TVIz2CM0sIIpYXJQ0rVdbXk9fSM/wYVFdDVdWYykXC2NXby2O6TPLr7JIdPjbBHARTl57FqYQUX11Vy8aIqLpyfPMY6U/7wovEET+1vY+OBU8TijhkYkJeX/Baa/Eaa/LcgkkdDdRkr5pcHHpCd/cMUF0QoLpj4hUzuyW/MRfl5mGXG4RB358ipfrYc6WDL4Xa2HOlgf0vviOuumF/O+17dwNsuqdMFXFnMzLa6+9qRlgW5R3AlsN/dD6aKuB+4ARgxCID1wG1BFbPxwCk+8v3tQPJD9PzaWTTMLePxPc3Mryzmng9cyYr5FZN+3/LiAsqLR/jw7R35j+psiZ4ePvb97fQMRukeiHH4VB8tPUPk5xmvPr+aD77mPBrmlp35ppZIOD2DMXYf72JHUxcPbm3i7k1HzrxfZUkB9XNKWDKnjIsXVXLZktm8oq5yUh9ciYRzsK2X5452svtYFyWF+cyrKGJ+RTG1FcXUlhdRVVrArKL8ET/Y4gkn4T7mB7K70z0YwwwK8vLIjyQPNWw+3M4jO47z010nae8bpjA/j6JIHg6pb6HJb6vuL06nH5EoiBjLamZx4fxyVsyvYMX8ci6cX86CymLiCaetd5jm7kGauwdxYNWCChbNLnlJO9ydjv4o+072sLOpk51NXexo6qSpYwAzqKsq4byaWSyrKaOuqoRYwhmOJZKPeIJTvcOc6BrgZNcgx7sGGIwmKCmIUFNeRE15EdWzCqkoLqCoIO/Mt+niguThx/LifMqL8ikvLqCkMLmsMD+PwkgeBfl5DAwn91B7U4+CiNEwt4z6OaVn/s/dnaaOATYfbmfz4Q4OtPTSNxxLvnY4Ru9gjL7hOADlxflcvmQ2b149j8JIhEheMnAjZly6eDZXNMzOmACTYAS5R3ATcK27/3Fq+j3AK939wyOsuwR4Gljk7vERlm8ANgAsXrz48iNHjpy9yrgGhuO80Nxz5rGvuZf9zT2srqvkyzddTFXpFB+7rKhIdgyPo6eolOv+9hEqigsoL072Pbx+RS2vW1E7oW/38YRzsLWXA619NLb3czT1ONDaS1PHAJD8cFy1oII19VXJD8cF5Vw4r5yyonyGYnEOtfWx72Ty/+XXx7rZfrSD7tQhr7LCCMPxBNH4S39P8vOMqtICKksKiCX8zIfTYDRBfp6xamEFl9ZXceni2VxSX0V7/zDPHelga+rR0jM0YptKCiJcs2oeb12zkNdcUD3uYGJDsTgHWvp4obmH50/2sO9kN/tO9vzWqYmlhREGo3FGOIxNeXE+qxZUcOH8cnoGYxxs6+NwWx9dA9Ez6yyaXcKaRVW8YlHysOHB1j4OtPZyqK2P/uEXf2XzDArz85hTWsj8ymIWVJWwoKKY2WWFdPYP09ozRGvvEK09Q/QOxhiKJRiMxhmKJYiNVNwkRPKM+tkl1M0uYX9LL83dQ2fat3J+BeXF+ZQURigrTP57fu0srmiYw/LaWeq4zQFj7REEGQTvBN58VhBc6e63jrDuJ0iGwEuWne3lHhqadh/6UPLsoGh09HUKCmDDhlH7CM5Va88Q24528NzRTp472sHuY11nvgWawbzyYlp7h8508kXyjPNrZnHZkuSH92WLZ3NedRkAHf3DNHcP0dwzSGvPEJ39w3T2R+noj9I1MEx+Xl6qMz35rXYwmmB7Ywc7m7p+64MSYPGcUi5fMpuVC8rJMyMad+KJZNgsq53FNStrKS08953VroFoMhxOdHOgtY+K4nxqK4qZV1HM/Ipi4u7sPZE8q2XP8W5eaO6lojifpTVlNMwtY2l1GctqZ3FxXSVzZxWNuI3TezYFEaMwkndOwyBH4wn6hmL0DCYfvUMx+odjZ/YyhmMJovEExQURyovzKSvMT4V5gsNtfRxq6+PQqT6a2vtZMreMKxpms7ZhDhfOK9cHvYQWBOuAT7v7m1PTfw3g7l8YYd1twJ+7+8bx3jdrguDAAbj4Yugf+Rg/AKWl03rWUCLhHOscYO+Jbp4/2cPhtj4WVpVwwfxyLpg3i6XVZVM+lG8snmBfcw87m7qYXVrIZUuqqC0vntJtiMj4wuoj2AwsN7OlwDHgZuAPRyjuQmA2sCnAWqbfsmXJ6wTOvo4AknsCBQXJ5dN46mhenlE/p5T6OaW8afX8adlmfiSP1QsrWb2wclq2JyKTF9jpFe4eAz4MPArsBR5w991m9hkze2vaquuB+z2oXZMwXXdd8hv/hg3JPoO8vOS/GzYk5+tiMhHJAIEdGgpK1hwaEhHJIGMdGtIVSSIiOU5BICKS4xQEIiI5TkEgIpLjFAQiIjlOQSAikuOy7vRRM2sF0gcbqgS6Rlj17PljTY/2vBpoO8eSR6tvMuuNtGwi89TGzGnfaMvHmzeR9mZKG3P1b3Gk+ZnYxiXuXjPiEnfP6gdw+0TmjzU9xvMtQdU3mfVGWjaReWpj5rTv5bZxIu3NlDbm6t9iNrbx7MdMODT0yATnjzU92vOpMNH3G2u9kZZNZJ7aODWmon2jLR9v3kTbe66C+hmONH+m/Z6OND/T2/hbsu7Q0HQysy0+ypV4M8VMb+NMbx+ojTNFmG2cCXsEQbo97AKmwUxv40xvH6iNM0VobdQegYhIjtMegYhIjlMQiIjkuJwJAjO708xazGzXy3jt5Wb2azPbb2bfsLQ7eZvZrWa2z8x2m9nfTW3Vk6pxyttnZp82s2Nmtj31uH7qK59UnYH8DFPLP25mbmbVU1fx5AX0c/ysme1M/QwfM7OFU1/5pOoMoo1fNrPnU+38oZlVTX3lE64xiPa9M/UZkzCzqe9QPtfzVrPlAbwGuAzY9TJe+yywDjDgp8B1qfmvA34OFKWma2dY+z4NfFs00EgAAAXdSURBVDzsn12QbUwtqyd5A6UjQPVMayNQkbbOXwDfmoFtfBOQn3r+JeBLM6x9K4ELgV8Ca6e65pzZI3D3J4H29HlmtszMfmZmW83sf81sxdmvM7MFJP+QNnnyJ3IP8LbU4j8DvujuQ6lttATbitEF1L6MEmAbvwb8XyD0MyeCaKO7d6etWkbI7QyojY958q6IAE8Di4JtxegCat9ed98XVM05EwSjuB241d0vBz4O/PMI69QBTWnTTal5ABcAv2tmz5jZ/5jZFYFWO3nn2j6AD6d2t+80s9nBlfqynVMbLXnb1GPuviPoQs/BOf8czexzZtYIvAv4VIC1vlxT8bt62i0kv01nkqls35QL8ub1Gc3MZgGvBh5MO1xcNNKqI8w7/Y0qH5gNvAq4AnjAzM5LpXmopqh9/wJ8NjX9WeCrJP/IMsK5ttHMSoFPkjyskJGm6OeIu38S+KSZ/TXJe4nfNsWlvmxT1cbUe30SiAH/PpU1noupbF9QcjYISO4Ndbr7JekzzSwCbE1NPkzywzB9N3MRcDz1vAn4j9QH/7NmliA5cFRrkIVP0Dm3z92b0173r8CPgyz4ZTjXNi4DlgI7Un+gi4DnzOxKdz8ZcO0TNRW/p+m+B/wXGRQETFEbzex9wFuAN2TCl7E0U/0znHphdaiE8QAaSOvAATYC70w9N2DNKK/bTPJb/+kOnOtT8/8U+Ezq+QVAI6mL9GZI+xakrfOXwP0z7Wd41jqHCbmzOKCf4/K0dW4FHpqBbbwW2APUhN22INqXtvyXBNBZHPp/2DT+YO4DTgBRkt/kP0Dy2+DPgB2pX6JPjfLatcAu4ADwzdMf9kAhcG9q2XPA62dY+74L/BrYSfIby4Lpas90tfGsdUIPgoB+jj9Izd9JclCyuhnYxv0kv4htTz1COzMqoPbdmHqvIaAZeHQqa9YQEyIiOS7XzxoSEcl5CgIRkRynIBARyXEKAhGRHKcgEBHJcQoCmRHMrHeat3eHma2aoveKp0YG3WVmj4w3cqaZVZnZh6Zi2yKgO5TJDGFmve4+awrfL99fHMQsUOm1m9ndwAvu/rkx1m8AfuzuF01HfTLzaY9AZiwzqzGzH5jZ5tTjqtT8K81so5ltS/17YWr++83sQTN7BHjMzK42s1+a2UOpse7/PW18+F+eHhfezHpTg7rtMLOnzWxeav6y1PRmM/vMBPdaNvHigHizzOwJM3vOkmPU35Ba54vAstRexJdT6/6f1HZ2mtnfTuF/o+QABYHMZF8HvubuVwDvAO5IzX8eeI27X0pyJM7Pp71mHfA+d399avpS4CPAKuA84KoRtlMGPO3ua4AngQ+mbf/rqe2PO2ZMauyZN5C8ihtgELjR3S8jee+Lr6aC6K+AA+5+ibv/HzN7E7AcuBK4BLjczF4z3vZETsvlQedk5rsGWJU24mOFmZUDlcDdZrac5OiOBWmvedzd08eSf9bdmwDMbDvJMWR+ddZ2hnlxQL6twBtTz9fx4n0Pvgd8ZZQ6S9LeeyvweGq+AZ9PfagnSO4pzBvh9W9KPbalpmeRDIYnR9meyG9REMhMlgesc/eB9Jlm9o/AL9z9xtTx9l+mLe476z2G0p7HGflvJuovdraNts5YBtz9EjOrJBkofw58g+S9A2qAy909amaHgeIRXm/AF9z925PcrgigQ0Mysz1Gcux9AMzs9DDAlcCx1PP3B7j9p0kekgK4ebyV3b2L5K0kP25mBSTrbEmFwOuAJalVe4DytJc+CtySGvceM6szs9opaoPkAAWBzBSlZtaU9vgoyQ/VtakO1D0khw0H+DvgC2b2FBAJsKaPAB81s2eBBUDXeC9w920kR6i8meTNVdaa2RaSewfPp9Y5BTyVOt30y+7+GMlDT5vM7NfAQ/x2UIiMSaePigQkdQe0AXd3M7sZWO/uN4z3OpHppj4CkeBcDnwzdaZPJxl0m0+RdNojEBHJceojEBHJcQoCEZEcpyAQEclxCgIRkRynIBARyXH/H8od1M1UIGOQAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "learn.recorder.plot(suggestion=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.706033</td>\n",
       "      <td>0.743273</td>\n",
       "      <td>0.245192</td>\n",
       "      <td>00:44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.705693</td>\n",
       "      <td>0.737217</td>\n",
       "      <td>0.235577</td>\n",
       "      <td>00:44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.710942</td>\n",
       "      <td>0.736607</td>\n",
       "      <td>0.235577</td>\n",
       "      <td>00:44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.699715</td>\n",
       "      <td>0.722140</td>\n",
       "      <td>0.232372</td>\n",
       "      <td>00:45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.705543</td>\n",
       "      <td>0.692909</td>\n",
       "      <td>0.211538</td>\n",
       "      <td>00:45</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.24519230425357819.\n",
      "Better model found at epoch 1 with error_rate value: 0.23557692766189575.\n",
      "Better model found at epoch 3 with error_rate value: 0.23237179219722748.\n",
      "Better model found at epoch 4 with error_rate value: 0.21153846383094788.\n"
     ]
    }
   ],
   "source": [
    "lr = 2.29e-6\n",
    "learn.fit_one_cycle(5, slice(lr/40, lr))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn.save('128')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn.load('128', purge=True);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = get_data(32, 256)\n",
    "learn.data = data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.711063</td>\n",
       "      <td>0.656895</td>\n",
       "      <td>0.195513</td>\n",
       "      <td>01:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.728751</td>\n",
       "      <td>0.658596</td>\n",
       "      <td>0.189103</td>\n",
       "      <td>01:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.682873</td>\n",
       "      <td>0.651639</td>\n",
       "      <td>0.160256</td>\n",
       "      <td>01:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.658013</td>\n",
       "      <td>0.648208</td>\n",
       "      <td>0.173077</td>\n",
       "      <td>01:02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.636100</td>\n",
       "      <td>0.639604</td>\n",
       "      <td>0.176282</td>\n",
       "      <td>01:02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.1955128163099289.\n",
      "Better model found at epoch 1 with error_rate value: 0.18910256028175354.\n",
      "Better model found at epoch 2 with error_rate value: 0.16025641560554504.\n"
     ]
    }
   ],
   "source": [
    "learn.to_fp16()\n",
    "learn.freeze()\n",
    "learn.fit_one_cycle(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='0' class='' max='1', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      0.00% [0/1 00:00<00:00]\n",
       "    </div>\n",
       "    \n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table><p>\n",
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='81' class='' max='163', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      49.69% [81/163 00:39<00:40 2.2175]\n",
       "    </div>\n",
       "    "
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.\n",
      "Min numerical gradient: 1.00E-05\n",
      "Min loss divided by 10: 7.59E-08\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "learn.unfreeze()\n",
    "learn.lr_find()\n",
    "learn.recorder.plot(suggestion=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.647792</td>\n",
       "      <td>0.649682</td>\n",
       "      <td>0.163462</td>\n",
       "      <td>01:20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.644281</td>\n",
       "      <td>0.647284</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>01:21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.654149</td>\n",
       "      <td>0.641619</td>\n",
       "      <td>0.158654</td>\n",
       "      <td>01:21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.647181</td>\n",
       "      <td>0.639315</td>\n",
       "      <td>0.158654</td>\n",
       "      <td>01:21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.656141</td>\n",
       "      <td>0.637700</td>\n",
       "      <td>0.153846</td>\n",
       "      <td>01:21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.16346153616905212.\n",
      "Better model found at epoch 2 with error_rate value: 0.1586538404226303.\n",
      "Better model found at epoch 4 with error_rate value: 0.1538461595773697.\n"
     ]
    }
   ],
   "source": [
    "lr = 1e-5\n",
    "learn.fit_one_cycle(5, slice(lr/40, lr))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn.save('256')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn.load('256', purge=True)\n",
    "data = get_data(16, 384)\n",
    "learn.data = data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.681966</td>\n",
       "      <td>0.613011</td>\n",
       "      <td>0.153846</td>\n",
       "      <td>01:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.711465</td>\n",
       "      <td>0.695941</td>\n",
       "      <td>0.190705</td>\n",
       "      <td>01:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.668756</td>\n",
       "      <td>0.689204</td>\n",
       "      <td>0.193910</td>\n",
       "      <td>01:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.644382</td>\n",
       "      <td>0.622915</td>\n",
       "      <td>0.157051</td>\n",
       "      <td>01:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.613580</td>\n",
       "      <td>0.598824</td>\n",
       "      <td>0.144231</td>\n",
       "      <td>01:53</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.1538461595773697.\n",
      "Better model found at epoch 4 with error_rate value: 0.14423076808452606.\n"
     ]
    }
   ],
   "source": [
    "learn.to_fp16()\n",
    "learn.freeze()\n",
    "learn.fit_one_cycle(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='0' class='' max='1', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      0.00% [0/1 00:00<00:00]\n",
       "    </div>\n",
       "    \n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table><p>\n",
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='79' class='' max='327', style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      24.16% [79/327 00:40<02:06 2.3793]\n",
       "    </div>\n",
       "    "
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.\n",
      "Min numerical gradient: 6.31E-07\n",
      "Min loss divided by 10: 5.75E-05\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "learn.unfreeze()\n",
    "learn.lr_find()\n",
    "learn.recorder.plot(suggestion=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>error_rate</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.615117</td>\n",
       "      <td>0.598098</td>\n",
       "      <td>0.144231</td>\n",
       "      <td>02:42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.596198</td>\n",
       "      <td>0.592518</td>\n",
       "      <td>0.144231</td>\n",
       "      <td>02:43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.600637</td>\n",
       "      <td>0.583949</td>\n",
       "      <td>0.134615</td>\n",
       "      <td>02:43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0.608198</td>\n",
       "      <td>0.584628</td>\n",
       "      <td>0.134615</td>\n",
       "      <td>02:43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0.606423</td>\n",
       "      <td>0.584938</td>\n",
       "      <td>0.134615</td>\n",
       "      <td>02:43</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Better model found at epoch 0 with error_rate value: 0.14423076808452606.\n",
      "Better model found at epoch 2 with error_rate value: 0.13461539149284363.\n"
     ]
    }
   ],
   "source": [
    "lr = 5.75E-05\n",
    "learn.fit_one_cycle(5, slice(lr/40, lr))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "learn.save('384')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
